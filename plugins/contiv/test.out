=== RUN   TestBasicStuff
time="2018-11-15 12:58:51.18657" level=info msg="Following IPs are excluded from NodeCIDR: [10.10.10.1]" loc="ipam/ipam.go(118)" logger=defaultLogger
time="2018-11-15 12:58:51.18699" level=info msg="IPAM values loaded: &{logger:0xc0000f4000 mutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} nodeID:1 nodeName: podSubnetAllNodes:{IP:[10 1 0 0] Mask:[255 255 0 0]} podSubnetThisNode:{IP:[10 1 1 0] Mask:[255 255 255 0]} podSubnetGatewayIP:[10 1 1 1] podVPPSubnet:{IP:[10 2 1 0] Mask:[255 255 255 0]} assignedPodIPs:map[] hostInterconnectSubnetAllNodes:{IP:[172 30 0 0] Mask:[255 255 0 0]} hostInterconnectSubnetThisNode:{IP:[172 30 1 0] Mask:[255 255 255 0]} hostInterconnectIPInVpp:[172 30 1 1] hostInterconnectIPInLinux:[172 30 1 2] nodeInterconnectDHCP:false nodeInterconnectSubnet:{IP:[192 168 16 0] Mask:[255 255 255 0]} vxlanSubnet:{IP:[192 168 30 0] Mask:[255 255 255 0]} serviceCIDR:{IP:[10 96 0 0] Mask:[255 240 0 0]} excludededIPsfromNodeSubnet:[168430081] lastPodIPAssigned:1 config:0x284c5f0}" loc="ipam/ipam.go(120)" logger=defaultLogger
time="2018-11-15 12:58:51.18720" level=warning msg="No http handler provided or getNodeIP callback, skipping registration of IPAM REST handlers" loc="contiv/rest_handlers.go(41)" logger=defaultLogger
Resync against empty K8s state ---------------------------
time="2018-11-15 12:58:51.18733" level=info msg="Starting RESYNC no. 1" loc="contiv/remote_cni_server.go(376)" logger=defaultLogger
time="2018-11-15 12:58:51.18750" level=info msg="IPAM state after RESYNC: (assignedPodIPs=map[], lastPodIPAssigned=1)" loc="ipam/ipam.go(175)" logger=defaultLogger
time="2018-11-15 12:58:51.18765" level=info msg="Existing interfaces: map[1:GigabitEthernet0/8/0 2:GigabitEthernet0/9/0]" loc="contiv/remote_cni_server.go(738)" logger=defaultLogger
time="2018-11-15 12:58:51.18780" level=info msg="Configuring physical NIC GigabitEthernet0/8/0" loc="contiv/remote_cni_server.go(792)" logger=defaultLogger
time="2018-11-15 12:58:51.18795" level=info msg="Configuring GigabitEthernet0/8/0 to use DHCP" loc="contiv/remote_cni_server.go(835)" logger=defaultLogger
RESYNC transaction (Remote CNI server resync no. 1):
    - key: linux/config/v2/interface/veth-vpp1
      value: name:"veth-vpp1" type:VETH host_if_name:"vpp1" enabled:true ip_addresses:"172.30.1.2/24" veth:<peer_if_name:"veth-vpp2" > 
    - key: linux/config/v2/interface/veth-vpp2
      value: name:"veth-vpp2" type:VETH host_if_name:"vpp2" enabled:true veth:<peer_if_name:"veth-vpp1" > 
    - key: linux/config/v2/route/10.1.0.0/16/veth-vpp1
      value: outgoing_interface:"veth-vpp1" scope:GLOBAL dst_network:"10.1.0.0/16" gw_addr:"172.30.1.1" 
    - key: linux/config/v2/route/10.96.0.0/12/veth-vpp1
      value: outgoing_interface:"veth-vpp1" scope:GLOBAL dst_network:"10.96.0.0/12" gw_addr:"172.30.1.1" 
    - key: vpp/config/v2/bd/vxlanBD
      value: name:"vxlanBD" forward:true interfaces:<name:"vxlanBVI" bridged_virtual_interface:true split_horizon_group:1 > 
    - key: vpp/config/v2/interface/GigabitEthernet0/8/0
      value: name:"GigabitEthernet0/8/0" type:ETHERNET_CSMACD enabled:true set_dhcp_client:true 
    - key: vpp/config/v2/interface/GigabitEthernet0/9/0
      value: name:"GigabitEthernet0/9/0" type:ETHERNET_CSMACD enabled:true ip_addresses:"10.10.20.5/24" 
    - key: vpp/config/v2/interface/afpacket-vpp2
      value: name:"afpacket-vpp2" type:AF_PACKET_INTERFACE enabled:true phys_address:"34:3c:00:00:00:01" ip_addresses:"172.30.1.1/24" afpacket:<host_if_name:"vpp2" > 
    - key: vpp/config/v2/interface/vxlanBVI
      value: name:"vxlanBVI" vrf:1 type:SOFTWARE_LOOPBACK enabled:true phys_address:"12:2b:00:00:00:01" ip_addresses:"192.168.30.1/24" 
    - key: vpp/config/v2/ipneigh
      value: mode:IPv4 
    - key: vpp/config/v2/route/vrf/0/dst/10.0.2.15/32/gw/172.30.1.2
      value: dst_network:"10.0.2.15/32" next_hop_addr:"172.30.1.2" outgoing_interface:"afpacket-vpp2" 
    - key: vpp/config/v2/route/vrf/0/dst/10.1.0.0/16/gw/0.0.0.0
      value: type:INTER_VRF dst_network:"10.1.0.0/16" via_vrf_id:1 
    - key: vpp/config/v2/route/vrf/0/dst/10.3.1.10/32/gw/172.30.1.2
      value: dst_network:"10.3.1.10/32" next_hop_addr:"172.30.1.2" outgoing_interface:"afpacket-vpp2" 
    - key: vpp/config/v2/route/vrf/0/dst/172.30.0.0/16/gw/0.0.0.0
      value: type:INTER_VRF dst_network:"172.30.0.0/16" via_vrf_id:1 
    - key: vpp/config/v2/route/vrf/1/dst/0.0.0.0/0/gw/0.0.0.0
      value: type:INTER_VRF vrf_id:1 dst_network:"0.0.0.0/0" 
    - key: vpp/config/v2/route/vrf/1/dst/10.1.0.0/16/gw/0.0.0.0
      value: type:DROP vrf_id:1 dst_network:"10.1.0.0/16" 
    - key: vpp/config/v2/route/vrf/1/dst/172.30.0.0/16/gw/0.0.0.0
      value: type:DROP vrf_id:1 dst_network:"172.30.0.0/16" 
    - key: vpp/config/v2/route/vrf/1/dst/172.30.1.0/24/gw/0.0.0.0
      value: type:INTER_VRF vrf_id:1 dst_network:"172.30.1.0/24" 
--- FAIL: TestBasicStuff (0.01s)
panic: runtime error: invalid memory address or nil pointer dereference [recovered]
	panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x62dbc6]

goroutine 6 [running]:
testing.tRunner.func1(0xc000474500)
	/usr/local/go/src/testing/testing.go:792 +0x387
panic(0x1511900, 0x28405a0)
	/usr/local/go/src/runtime/panic.go:513 +0x1b9
net.networkNumberAndMask(0x0, 0x2, 0x1, 0x1, 0x1, 0xc000041894, 0xc000041895)
	/usr/local/go/src/net/ip.go:477 +0x26
net.(*IPNet).String(0x0, 0x0, 0x0)
	/usr/local/go/src/net/ip.go:527 +0x40
github.com/contiv/vpp/plugins/contiv.(*remoteCNIserver).String(0xc000490140, 0x1906840, 0xc00003b560)
	/home/mlenco/go/src/github.com/contiv/vpp/plugins/contiv/remote_cni_server.go:364 +0x872
github.com/contiv/vpp/plugins/contiv.(*remoteCNIserver).Resync(0xc000490140, 0x18e4940, 0xc00003aa80, 0x0, 0x0)
	/home/mlenco/go/src/github.com/contiv/vpp/plugins/contiv/remote_cni_server.go:439 +0x606
github.com/contiv/vpp/plugins/contiv.TestBasicStuff(0xc000474500)
	/home/mlenco/go/src/github.com/contiv/vpp/plugins/contiv/remote_cni_server_test.go:188 +0x8e2
testing.tRunner(0xc000474500, 0x17d2d40)
	/usr/local/go/src/testing/testing.go:827 +0xbf
created by testing.(*T).Run
	/usr/local/go/src/testing/testing.go:878 +0x353
exit status 2
FAIL	github.com/contiv/vpp/plugins/contiv	0.060s
